---
layout: default
---

<h1>{{ page.title }}</h1>

<table>
  <tr>
    <th>Impact Rank</th>
    <td id="impactRank">Calculating...</td>
  </tr>
  <tr>
    <th>Lives Saved</th>
    <td>{{ page.impact }}</td>
  </tr>
  <tr>
    <th>Donated</th>
    <td>{{ page.donated }}</td>
  </tr>
  <tr>
    <th>Cost/Life</th>
    <td id="costPerLife">Calculating...</td>
  </tr>
  <tr>
    <th>Net Worth</th>
    <td>{{ page.netWorth }}</td>
  </tr>
</table>

<h2>Donations</h2>
{% if page.donations %}
  <table>
    <thead>
      <tr>
        <th>Date</th>
        <th>Amount</th>
        <th>Recipient</th>
        <th>Area</th>
        <th>Lives Saved</th>
        <th>Cost/Life</th>
      </tr>
    </thead>
    <tbody>
      {% for donation in page.donations %}
        {% assign amount_str = donation.amount | remove: '$' | remove: ',' %}
        
        {% if donation.amount contains 'B' %}
          {% assign multiplier = 1000000000 %}
          {% assign amount_str = amount_str | remove: 'B' %}
        {% elsif donation.amount contains 'M' %}
          {% assign multiplier = 1000000 %}
          {% assign amount_str = amount_str | remove: 'M' %}
        {% elsif donation.amount contains 'K' %}
          {% assign multiplier = 1000 %}
          {% assign amount_str = amount_str | remove: 'K' %}
        {% else %}
          {% assign multiplier = 1 %}
        {% endif %}
        
        {% assign amount_float = amount_str | times: 1.0 %}
        {% assign amount_numeric = amount_float | times: multiplier %}
        
        {% assign cost_per_life = amount_numeric | divided_by: donation.lives_saved | round %}
        <tr>
          <td>{{ donation.date }}</td>
          <td><a href="{{ donation.reference }}" target="_blank">{{ donation.amount }}</a></td>
          <td>{{ donation.recipient }}</td>
          <td>{{ donation.area }}</td>
          <td>{{ donation.lives_saved }}</td>
          <td>${{ cost_per_life | number_with_delimiter }}</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
{% else %}
  <p>No donation data available.</p>
{% endif %}

<script src="{{ '/assets/js/common.js' | relative_url }}"></script>
<script src="{{ '/assets/js/compute_ranks.js' | relative_url }}"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
  const data = [
    {% for person in site.people %}
      {
        name: "{{ person.title }}",
        impact: "{{ person.impact }}",
        donated: "{{ person.donated }}",
        netWorth: "{{ person.netWorth }}"
      }{% unless forloop.last %},{% endunless %}
    {% endfor %}
  ];

  const rankedData = computeRanks(data);
  const currentPerson = rankedData.find(p => p.name === "{{ page.title }}");
  
  if (currentPerson) {
    document.getElementById('impactRank').textContent = currentPerson.rank;
  }

  const impact = parseDollarAmount("{{ page.impact }}");
  const donated = parseDollarAmount("{{ page.donated }}");
  const costPerLife = Math.round(donated / impact);

  document.getElementById('costPerLife').textContent = `$${costPerLife.toLocaleString()}`;
});
</script>
