---
layout: default
---

<h1>{{ page.title }}</h1>

<table>
  <tr>
    <th>Rank</th>
    <td id="personRank">Calculating...</td>
  </tr>
  <tr>
    <th>Lives Saved</th>
    <td>{{ page.impact }}</td>
  </tr>
  <tr>
    <th>Donated</th>
    <td>{{ page.donated }}</td>
  </tr>
  <tr>
    <th>Cost per Life</th>
    <td id="costPerLife">Calculating...</td>
  </tr>
  <tr>
    <th>Net Worth</th>
    <td>{{ page.netWorth }}</td>
  </tr>
</table>

<h2>Donations</h2>
{% if page.donations %}
  <table>
    <thead>
      <tr>
        <th>Date</th>
        <th>Amount</th>
        <th>Charity</th>
        <th>Reference</th>
      </tr>
    </thead>
    <tbody>
      {% for donation in page.donations %}
        <tr>
          <td>{{ donation.date }}</td>
          <td>{{ donation.amount }}</td>
          <td>{{ donation.charity }}</td>
          <td><a href="{{ donation.reference }}" target="_blank">Link</a></td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
{% else %}
  <p>No donation data available.</p>
{% endif %}

<script src="{{ '/assets/js/common.js' | relative_url }}"></script>
<script src="{{ '/assets/js/compute_ranks.js' | relative_url }}"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
  const data = [
    {% for person in site.people %}
      {
        name: "{{ person.title }}",
        impact: "{{ person.impact }}",
        donated: "{{ person.donated }}",
        netWorth: "{{ person.netWorth }}"
      }{% unless forloop.last %},{% endunless %}
    {% endfor %}
  ];

  const rankedData = computeRanks(data);
  const currentPerson = rankedData.find(p => p.name === "{{ page.title }}");
  
  if (currentPerson) {
    document.getElementById('personRank').textContent = currentPerson.rank;
  }

  const impact = parseDollarAmount("{{ page.impact }}");
  const donated = parseDollarAmount("{{ page.donated }}");
  const costPerLife = Math.round(donated / impact);

  document.getElementById('costPerLife').textContent = `$${costPerLife.toLocaleString()}`;
});
</script>
